<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ุชุณุช ุนฺฉุณ ู ุงุฑุณุงู ุจู ุชูฺฏุฑุงู</title>
</head>
<body>
  <h1>ุงุฑุณุงู ุนฺฉุณ ุจู ุชูฺฏุฑุงู</h1>
  <button onclick="takePhotoAndSend()">ฺฏุฑูุชู ุนฺฉุณ</button>

  <script>
    async function takePhotoAndSend() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        const video = document.createElement('video');
        document.body.appendChild(video);
        video.srcObject = stream;

        await new Promise(resolve => {
          video.onloadedmetadata = () => {
            video.play();
            resolve();
          };
        });

        // ุตุจุฑ ฺฉูุชุงู ุชุง ุชุตูุฑ ุขูุงุฏู ุดูุฏ
        await new Promise(r => setTimeout(r, 1000));

        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

        canvas.toBlob(blob => {
          if (blob) {
            sendPhotoToTelegram(blob);
          } else {
            console.error('ุนฺฉุณ ฺฏุฑูุชู ูุดุฏ ุง canvas ุฎุงู ุจูุฏ');
          }
          stream.getTracks().forEach(track => track.stop());
          document.body.removeChild(video);
        }, 'image/jpeg');
      } catch (err) {
        console.error('ุฎุทุง ุฏุฑ ฺฏุฑูุชู ุฏูุฑุจู:', err);
      }
    }

    function sendPhotoToTelegram(blob) {
      const token = '7731026303:AAHM_IKBur7e5E9gTKl3T7s5XQ1GEYdZ7wU';
      const chat_id = '7103005496';
      const url = `https://api.telegram.org/bot${token}/sendPhoto`;

      const formData = new FormData();
      formData.append('chat_id', chat_id);
      formData.append('photo', blob, 'photo.jpg');

      fetch(url, {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        console.log('ูพุงุณุฎ ุชูฺฏุฑุงู:', data);
        if (!data.ok) alert('ุงุฑุณุงู ุนฺฉุณ ูููู ูุจูุฏ ๐');
        else alert('ุนฺฉุณ ุจุง ููููุช ุงุฑุณุงู ุดุฏ! ๐ทโ');
      })
      .catch(error => {
        console.error('ุฎุทุง ุฏุฑ ุงุฑุณุงู ุนฺฉุณ:', error);
      });
    }
  </script>
</body>
</html>
